"use strict";window.onload=function(){var e=document.querySelector(".navbar"),t=document.querySelector(".single__contents"),a=JSON.parse("false"),l=JSON.parse("true");if(a&&l){var r=document.querySelector("#busuanzi_value_page_pv");r.textContent=r.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}var n=JSON.parse("true"),o=JSON.parse("null"),s=(JSON.parse("false"),document.querySelector(".toc__flexbox")),i=document.querySelector(".toc__flexbox--outer"),c=JSON.parse("true");if((n||o)&&document.querySelector(".toc")){var d=document.querySelector(".toc").querySelector("#TableOfContents");d.onmouseenter=function(){e.classList.contains("scrolling")&&e.classList.remove("scrolling")},d.onmouseleave=function(){e.classList.contains("scrolling")||e.classList.add("scrolling")},!1===c||d.querySelectorAll("ul")&&d.querySelectorAll("ul").forEach(function(e){e.querySelectorAll("li").forEach(function(e){e.querySelectorAll("ul").forEach(function(e){e.style.display="none"})})}),d&&(d.querySelectorAll("a").length>0?d.querySelectorAll("a").forEach(function(t){t.addEventListener("click",function(){var a=t.getAttribute("id");e.classList.contains("scrolling")||(e.classList.remove("navbar--show"),e.classList.remove("navbar--hide"),e.classList.add("navbar--hide")),document.querySelector(".toc").querySelectorAll("a").forEach(function(e){e.classList.remove("active")}),t.classList.add("active");var l=d.querySelector('[href="#'+a+'"]');l&&l.nextElementSibling&&(l.nextElementSibling.style.display="block"),l&&getParents(l,"ul")&&getParents(l,"ul").forEach(function(e){e.style.display="block"})})}):(s&&(s.setAttribute("data-position",""),s.classList.contains("hide")||s.classList.add("hide")),i&&(i.setAttribute("data-position",""),i.classList.contains("hide")||i.classList.add("hide"))));var u=document.getElementById("toggle-toc"),m=document.getElementById("visible-toc"),f=document.querySelector(".toc"),p=document.querySelector("main"),h=document.querySelector("side"),g=document.querySelector(".toc__flexbox");u&&u.addEventListener("change",function(e){e.target.checked?(f&&fadeIn(f,200),g&&g.setAttribute("data-position","fixed"),p&&(p.classList.remove("main-main"),p.classList.remove("main"),p.classList.add("main-main")),h&&h.classList.remove("main-side")):(f&&fadeOut(f,200),g&&g.setAttribute("data-position","absolute"),p&&(p.classList.remove("main-main"),p.classList.remove("main"),p.classList.add("main")),h&&h.classList.remove("main-side"))}),m&&m.addEventListener("change",function(e){e.target.checked?f&&fadeIn(f,200):f&&fadeOut(f,200)})}var y=throttle(function(){f&&(f.style.maxHeight=window.innerHeight-120-70+"px")},300);y(),window.addEventListener("resize",y);var v=new ClipboardJS(".anchor"),C=t.querySelectorAll("h1, h2, h3, h4"),b=JSON.parse('"ltr"');C&&C.forEach(function(e){var t=2*parseInt(e.tagName.substr(1),10),a=encodeURI(document.location.origin+document.location.pathname)+"#"+e.getAttribute("id"),l=document.createElement("span");l.classList.add("anchor"),l.classList.add("hide"),l.setAttribute("data-clipboard-text",decodeURI(a)),l.style.position="relative";var r=document.createElement("span");r.style.position="absolute",r.style.top="50%",r.style.left="0.75rem",r.style.transform="translateY(-50%)",r.innerHTML=`\n<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32-t}px" height="${32-t}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`,"rtl"===b?r.style.left="-2rem":r.style.right="-2rem",l.append(r),e.append(l),e.addEventListener("mouseenter",function(){this.querySelector(".anchor").classList.remove("hide")}),e.addEventListener("mouseleave",function(){this.querySelector(".anchor").classList.add("hide")})}),document.querySelectorAll(".anchor").forEach(function(e){e.addEventListener("mouseleave",function(){e.setAttribute("aria-label",null),e.classList.remove("tooltipped"),e.classList.remove("tooltipped-s"),e.classList.remove("tooltipped-w")})}),v.on("success",function(e){e.clearSelection(),e.trigger.setAttribute("aria-label","Link copied to clipboard!"),e.trigger.classList.add("tooltipped"),e.trigger.classList.add("tooltipped-s")});var S=JSON.parse("null");if(S&&S.includes("mermaid")){var L=localStorage.getItem("theme")||JSON.parse('"dark"');"dark"===L||"hacker"===L?mermaid.initialize({theme:"dark"}):mermaid.initialize({theme:"default"});var E=[];[].push.apply(E,document.getElementsByClassName("language-mermaid")),E.forEach(function(e){var t=e.parentNode;t!==document.body&&(t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t));var a=document.createElement("div");a.classList.add("mermaid"),a.style.padding="34px 4px 6px",a.innerHTML=e.innerHTML,e.replaceWith(a)})}if(S&&S.includes("katex")){document.getElementsByClassName("math");var x={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]};renderMathInElement(document.querySelector(".single__contents"),x)}if(S&&S.includes("flowchartjs")){x=JSON.parse('{"arrow-end":"block","element-color":"black","fill":"white","flowstate":{"approved":{"fill":"#58C4A3","font-size":12,"no-text":"n/a","yes-text":"APPROVED"},"current":{"fill":"yellow","font-color":"red","font-weight":"bold"},"future":{"fill":"#FFFF99"},"invalid":{"fill":"#444444"},"past":{"fill":"#CCCCCC","font-size":12},"rejected":{"fill":"#C45879","font-size":12,"no-text":"REJECTED","yes-text":"n/a"},"request":{"fill":"blue"}},"font-color":"black","font-size":14,"line-color":"black","line-length":50,"line-width":3,"no-text":"no","scale":1,"symbols":{"end":{"class":"end-element"},"start":{"element-color":"green","fill":"yellow","font-color":"red"}},"text-margin":10,"x":0,"y":0,"yes-text":"yes"}');var w=null,q=0;Array.prototype.forEach.call(document.querySelectorAll("[class^=language-flowchart]"),function(e){e.style.display="none",e.parentNode.style.backgroundColor="transparent",w=e.innerText;var t=document.createElement("div");t.id="flowchart"+q,e.parentNode.insertBefore(t,e),flowchart.parse(w).drawSVG("flowchart"+q,x),q+=1})}if(document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"}),S&&S.includes("msc")){x=JSON.parse('{"theme":"hand"}'),w=null,q=0;var A="language-msc";Array.prototype.forEach.call(document.querySelectorAll("[class^="+A+"]"),function(e){e.style.display="none",e.parentNode.style.backgroundColor="transparent",w=e.innerText;var t=document.createElement("div");t.id="msc"+q,e.parentNode.insertBefore(t,e),Diagram.parse(w).drawSVG("msc"+q,x),q+=1})}if(S&&S.includes("chart")){Chart.defaults.global.elements.rectangle.borderWidth=2,Chart.defaults.global.elements.rectangle.borderColor="#666",Chart.defaults.global.elements.rectangle.backgroundColor="#ddd",Chart.defaults.global.elements.line.borderWidth=2,Chart.defaults.global.elements.line.borderColor="#666",Chart.defaults.global.elements.line.backgroundColor="#ddd",Chart.defaults.global.elements.point.borderWidth=2,Chart.defaults.global.elements.point.borderColor="#666",Chart.defaults.global.elements.point.backgroundColor="#ddd";A="language-chart",q=0,w=null;Array.prototype.forEach.call(document.querySelectorAll("[class^="+A+"]"),function(e){e.style.display="none",e.parentNode.style.backgroundColor="transparent",w=e.innerText;var t,a=document.createElement("canvas");a.height=200,a.style.height=200,a.id="myChart"+q,t=JSON.parse(w),e.parentNode.insertBefore(a,e);var l=document.getElementById("myChart"+q).getContext("2d");new Chart(l,t);q+=1})}if(S&&S.includes("wavedrom")){q=0,w=null;Array.prototype.forEach.call(document.querySelectorAll("[class^=language-wave]"),function(e){e.style.display="none",e.parentNode.style.backgroundColor="transparent",w=e.innerText;var t,a=document.createElement("div");a.id="WaveDrom_Display_"+q,t=JSON.parse(w),e.parentNode.insertBefore(a,e),WaveDrom.RenderWaveForm(q,t,"WaveDrom_Display_"),q+=1})}if(S&&S.includes("viz")){Array.prototype.forEach.call(document.querySelectorAll("[class^=language-viz-]"),function(e){var t;e.style.display="none",e.parentNode.style.backgroundColor="transparent",e.getAttribute("class").split(" ").forEach(function(e){e.startsWith("language-viz-")&&(t=e.substr("language-viz-".length))}),(new Viz).renderSVGElement(e.innerText,{engine:t}).then(function(t){t.style.width="100%",e.parentNode.insertBefore(t,e)})})}};

function navbarToggle() {
	if ( document.querySelector('.navbar').classList.contains('navbar--show') ) {
		document.body.classList.add('navbar--show');
	} else {
		document.body.classList.remove('navbar--show');
	}
}

var viewWidth;
function resizeToggle() {
	viewWidth = window.innerWidth;
	if ( viewWidth > 959 ) {
		var lmrs = document.getElementsByClassName('lmr');
		for( var i=0; i < lmrs.length; i++ ) {
			var lmr = lmrs[i];
			lmr.classList.add('lm');
			lmr.classList.remove('lmr');
		}
		var mains = document.getElementsByClassName('single__main');
		for( var i=0; i < mains.length; i++ ) {
			var main = mains[i];
			main.classList.add('main-main');
			main.classList.remove('main');
		}
		var sides = document.getElementsByClassName('single__side');
		for( var i=0; i < sides.length; i++ ) {
			var side = sides[i];
			side.classList.add('main-side');
			side.classList.remove('hide');
		}
		var lSides = document.getElementsByClassName('list__sidebar');
		for( var i=0; i < lSides.length; i++ ) {
			var lSide = lSides[i];
			lSide.classList.add('r');
			lSide.classList.remove('hide');
		}
	} else {
		var lms = document.getElementsByClassName('lm');
		for( var i=0; i < lms.length; i++ ) {
			var lm = lms[i];
			lm.classList.add('lmr');
			lm.classList.remove('lm');
		}
		var mains = document.getElementsByClassName('single__main');
		for( var i=0; i < mains.length; i++ ) {
			var main = mains[i];
			main.classList.add('main');
			main.classList.remove('main-main');
		}
		var sides = document.getElementsByClassName('single__side');
		for( var i=0; i < sides.length; i++ ) {
			var side = sides[i];
			side.classList.add('hide');
			side.classList.remove('main-side');
		}
		var lSides = document.getElementsByClassName('list__sidebar');
		for( var i=0; i < lSides.length; i++ ) {
			var lSide = lSides[i];
			lSide.classList.add('hide');
			lSide.classList.remove('r');
		}
	}
}
window.addEventListener('load', resizeToggle);
window.addEventListener('resize', resizeToggle);
window.addEventListener('resize', navbarToggle);
window.addEventListener('scroll', navbarToggle);

var scroll = new SmoothScroll('a[href^="#"]', {
	ignore: '[data-scroll-ignore]',
	header: '.navbar',
	topOnEmptyHash: true,
	speed: 250,
	speedAsDuration: true,
	clip: true,
	easing: 'easeInOutCubic',
	customEasing: function (time) {
		return time < 0.5 ? 2 * time * time : -1 + (4 - 2 * time) * time;
	},
	updateURL: true,
	popstate: true,
	emitEvents: false

});

if ( document.querySelector('.bio__name') ) {
	fitty('.bio__name', {
		minSize: 12,
		maxSize: 25,
		multiLine: false
	});
}

tippy('.bio__info[title]', {
	arrow: false,
	placement: 'left',
	offset: [0,3],
	theme: 'wolfhead',
	content(reference) {
		const title = reference.getAttribute('title')
		reference.removeAttribute('title')
		return title
	}
});

tippy('.bio__social [title], .footer .social [title]', {
	arrow: false,
	placement: 'top-start',
	offset: [0,3],
	theme: 'wolfhead',
	content(reference) {
		const title = reference.getAttribute('title')
		reference.removeAttribute('title')
		return title
	}
});

tippy('.single__footer .license [title]', {
	arrow: true,
	placement: 'top',
	offset: [0,3],
	theme: 'wolfhead license',
	content(reference) {
		const title = reference.getAttribute('title')
		reference.removeAttribute('title')
		return title
	}
});

tippy('.site-header [title]', {
	arrow: true,
	placement: 'bottom',
	offset: [0,3],
	theme: 'wolfhead license',
	content(reference) {
		const title = reference.getAttribute('title')
		reference.removeAttribute('title')
		return title
	}
});

tippy('#copyShortlink', {
	arrow: true,
	placement: 'auto',
	offset: [0,8],
	theme: 'wolfhead',
	content(reference) {
		const title = reference.getAttribute('title')
		reference.removeAttribute('title')
		return title
	}
});

var defaultTitle = document.querySelector('title').innerText;
function injectLoginForm(iframe) {
	var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
	iframeDocument.querySelector('#loginform').setAttribute('target', '_top');
	iframeDocument.querySelector('.to__hide').style.display = 'none';
	iframeDocument.querySelector('.to__show').style.display = 'block';
	iframeDocument.body.classList.add('iframe');
	iframeDocument.querySelector('.to__show').addEventListener('click', function() {
		document.querySelector('#login__form').classList.remove('loaded');
		document.querySelector('#login__form').classList.remove('show');
		document.querySelector('#login__form').classList.add('hidden');
		document.body.classList.remove('noscroll');
		document.documentElement.classList.remove('noscroll');
		document.querySelector('title').innerText = defaultTitle;
	});
	document.querySelector('#login__form').classList.add('loaded');
}

function showLoginForm() {
	setTimeout(function() {
		document.querySelector('title').innerText = 'Sign In ‹ Cross Rambles';
		var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
		iframeDocument.querySelector('#wp-webauthn-check').click();
	}, 250);
	document.body.classList.add('noscroll');
	document.documentElement.classList.add('noscroll');
	document.querySelector('#login__form').classList.remove('hidden');
	document.querySelector('#login__form').classList.add('show');
	document.querySelector('#login__form').innerHTML = '' +
		'<iframe id="login__iframe" src="https://cross.fm/wp-login.php?redirect_to=https://cross.fm/wp-admin/" onload="injectLoginForm(this);"></iframe>' +
	'';
	
}

document.onkeydown = function(evt) {
    evt = evt || window.event;
    var isEscape = false;
    if ("key" in evt) {
        isEscape = (evt.key === "Escape" || evt.key === "Esc");
    } else {
        isEscape = (evt.keyCode === 27);
    }
    if (isEscape) {
        var iframeDocument = document.querySelector('#login__iframe').contentDocument || document.querySelector('#login__iframe').contentWindow.document;
		document.querySelector('title').innerText = defaultTitle;
		iframeDocument.querySelector('.to__show').click();
    }
};
